<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>api-record-write</title>
</head>

<body>
<h1>api-record-write</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>if saved successfully, the record in request and the one in response (in block) are identical (in address, by ==)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Errors that may occur</h3>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>7</td>
    <td><p>&lt;CKError 0x170059410: &quot;Request Rate Limited&quot; (7/2008); &quot;This operation has been rate limited&quot;; Retry after 1.0 seconds&gt;</p>
      <p>NSUnderlyingError		&lt;CKError 0x170059c50: &quot;Unknown Error&quot; (2008); Retry after 1.0 seconds&gt;</p>
      <p> CKRetryAfter		1</p>
      <p> NSDebugDescription		CKInternalErrorDomain: 2008</p>
      <p> CKErrorShouldThrottleClient		1</p>
      <p> NSLocalizedDescription		This operation has been rate limited</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>14</td>
    <td><p>&lt;CKError 0x174248850: &quot;Server Record Changed&quot; (14/2004); server message = &quot;record to insert already exists&quot;; uuid = DF95EB59-13E6-4F40-9CCF-D85EBA4CF768; container ID = &quot;iCloud.jx.Nutrition&quot;&gt;</p>
      <p>14</p>
      <p>CKErrorDomain</p>
      <p>Optional([ServerRecord, ContainerID, NSDebugDescription, AncestorRecord, RequestUUID, errorKey, NSLocalizedDescription, ClientRecord, NSUnderlyingError, ErrorDescription])</p>
      <p>&nbsp;</p>
      <p> ContainerID		iCloud.jx.Nutrition</p>
      <p> NSDebugDescription		CKInternalErrorDomain: 2004</p>
      <p>&nbsp;</p>
      <p> RequestUUID		DF95EB59-13E6-4F40-9CCF-D85EBA4CF768</p>
      <p> errorKey		ck1eb46f6</p>
      <p> NSLocalizedDescription		Error saving record &lt;CKRecordID: 0x12f775990; index.doc.txt:(_defaultZone:__defaultOwner__)&gt; to server: record to insert already exists</p>
      <p>&nbsp;</p>
      <p> NSUnderlyingError		&lt;CKError 0x170240f60: &quot;Unknown Error&quot; (2004); server message = &quot;record to insert already exists&quot;; uuid = DF95EB59-13E6-4F40-9CCF-D85EBA4CF768; container ID = &quot;iCloud.jx.Nutrition&quot;&gt;</p>
      <p> ErrorDescription		record to insert already exists</p>
      <p>&lt;CKRecord: 0x1741269a0; recordType=ArticleDoc, recordID=index.doc.txt:(_defaultZone:__defaultOwner__), recordChangeTag=(null), values={</p>
      <p> bluk = &quot;&lt;CKAsset: 0x17419cb10; size=348, path=\&quot;/private/var/mobile/Containers/Bundle/Application/CCF9D71A-7795-4975-961A-D443A459BDC9/Nutrition.app/-\U8425\U517b-\U98df\U6750-\U98df\U54c1/\U81b3\U98df\U5b9d\U5854/index.doc.txt\&quot;, signature=&lt;010b0c77 01769463 32c41e8f 85f6c05d f8e0a009 34&gt;, UUID=94B45DFF-1E27-476F-AD09-2A9285EF808B&gt;&quot;;</p>
      <p> filename = &quot;index.doc.txt&quot;;</p>
      <p>}&gt;</p></td>
    <td><ul>
      <li>
        <p>ServerRecord		&lt;CKRecord: 0x1701273a0; recordType=ArticleDoc, recordID=index.doc.txt:(_defaultZone:__defaultOwner__), recordChangeTag=i5qe3s08, values={</p>
        <p> bluk = &quot;&lt;CKAsset: 0x17019c2f0; </p>
        <ul>
          <li>size=175, </li>
          <li>signature=&lt;011b1725 cd59ea45 a40dd204 6736523e 880a5c9f c2&gt;&gt;&quot;;</li>
        </ul>
      </li>
    </ul>
      <blockquote>
        <p> filename = &quot;index.doc.txt&quot;;</p>
        <p>}&gt;</p>
      </blockquote>
      <ul>
        <li>
          <p>AncestorRecord		&lt;CKRecord: 0x170127620; recordType=ArticleDoc, recordID=index.doc.txt:(_defaultZone:__defaultOwner__), recordChangeTag=(null), values={</p>
          <p>}&gt;</p>
        </li>
        <li>
          <p>ClientRecord		&lt;CKRecord: 0x170127440; recordType=ArticleDoc, recordID=index.doc.txt:(_defaultZone:__defaultOwner__), recordChangeTag=(null), values={</p>
          <p>&nbsp; </p>
          <ul>
            <li>bluk = &quot;&lt;CKAsset: 0x17019cd80; size=348,
              <ul>
                <li>path=\&quot;/private/var/mobile/Containers/Bundle/Application/CCF9D71A-7795-4975-961A-D443A459BDC9/Nutrition.app/-\U8425\U517b-\U98df\U6750-\U98df\U54c1/\U81b3\U98df\U5b9d\U5854/index.doc.txt\&quot;, </li>
                <li>signature=&lt;010b0c77 01769463 32c41e8f 85f6c05d f8e0a009 34&gt;, </li>
                <li>UUID=94B45DFF-1E27-476F-AD09-2A9285EF808B, </li>
                <li>uploadReceipt=A4m6UQ/PaVq3deQo, flags=uploaded&gt;&quot;; </li>
              </ul>
            </li>
            <li>filename = &quot;index.doc.txt&quot;;</li>
          </ul>
        </li>
      </ul>
      <blockquote>
        <p>}&gt;</p>
      </blockquote></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><a href="https://developer.apple.com/library/ios/documentation/CloudKit/Reference/CKModifyRecordsOperation_class/index.html#//apple_ref/occ/cl/CKModifyRecordsOperation">CKModifyRecordsOperation</a></h2>
<p>&nbsp;</p>
<p>convenience init!(recordsToSave records: [AnyObject]!,<br />
  recordIDsToDelete recordIDs: [AnyObject]!)</p>
<p>var recordsToSave: [AnyObject]!</p>
<p>var recordIDsToDelete: [AnyObject]!</p>
<p>var savePolicy: CKRecordSavePolicy</p>
<p>@NSCopying var clientChangeTokenData: NSData!</p>
<p>var atomic: Bool</p>
<p>var perRecordProgressBlock: ((CKRecord!, Double) -&gt; Void)!</p>
<p>var perRecordCompletionBlock: ((CKRecord!, NSError!) -&gt; Void)!</p>
<p>var modifyRecordsCompletionBlock: (([AnyObject]!, [AnyObject]!, NSError!) -&gt; Void)!</p>
<p>&nbsp;</p>
<h2>CKRecordSavePolicy</h2>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>IfServerRecordUnchanged</td>
    <td>A policy that saves the record only if the local copy of the record is based on the record still on the server. The server maintains a change tag for each record automatically. When you fetch a record, that change tag is included with the rest of the record's data. If the change tag in your local record matches the change tag of the record on the server, the save operation proceeds normally. If the server record contains a newer change tag, the record is not saved and an error of type CKErrorServerRecordChanged is reported.</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>ChangedKeys</td>
    <td><p>A policy that saves only those fields of the record that actually changed, overwriting any values currently on the server. Unmodified fields are left untouched.</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>AllKeys</td>
    <td><p>A policy that saves all keys of the record (including those that have not changed) to the server, overwriting any values currently on the server. Keys present only on the server remain unchanged.</p>
      <p>It is possible for a server record to contain keys that are not present locally. Another client may have added keys to the record since the time you fetched the record. Also, if you used the desiredKeys property to request only a subset of keys during a previous fetch operation, saving that same record object would modify only the fetched keys and any keys added to the record since then.</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p></p>
</body>
</html>
