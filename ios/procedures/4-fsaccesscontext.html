<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>4-fsaccesscontext</title>
</head>

<body>
<h1>4-fsaccesscontext</h1>
<p>&nbsp;</p>
<h2>concepts</h2>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>object selective writing</td>
    <td><p>. For object's relationship, only write its uuid (in structure of {&quot;uuid&quot;:&quot;2233&quot;}) into file.</p>
    <p>object may have recurrsive reference to each other. </p>
    <p>writing should know how to stop (by depth? )</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>reading </td>
    <td><p>read then cache by modelType and uuid</p>
    <p>avoid one-object-multiple-instance case.</p>
    <p>model without context cannot od lazy loading or faulting</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>object-reference-cycle</td>
    <td>see object-reference-cycle.html</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>non-UUID key. </td>
    <td>multiple Person with same name are created as different instances! </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>wild property</td>
    <td><p>wild property are the object's property that is not defined in model.</p>
    <p>model-driven, or object/instance-driven approach.</p>
    <p>&nbsp;</p></td>
    <td><p>policies for wild property</p>
      <ul>
        <li>ignore wild property, not save</li>
        <li>save wild property, but not handle it.</li>
        <li>try best to handle it as if this is a model's missing but proper property.</li>
    </ul></td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<h2>roles and responsibilities</h2>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td><p>resource required</p>
    <p>dependency</p></td>
  </tr>
  <tr>
    <td>usecase central</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td><p>N/A</p>
    <p>singleton</p></td>
  </tr>
  <tr>
    <td>usecase</td>
    <td><p>as client of context </p>
    <p>business concepts: such as :</p>
    <ul>
      <li>set defaults, such as currentAccount.</li>
    </ul>
    <p>&nbsp;</p></td>
    <td>persistent media independent</td>
    <td>context</td>
  </tr>
  <tr>
    <td>context</td>
    <td><p>an operation center</p>
    <p>represents the destination </p>
    <p>not a singleton</p>
    <p>need to be configured</p>
    <p>depends on model and store. </p></td>
    <td><p>cache</p>
    <p>&nbsp;</p>
    <p>storeURL, </p>
    <p>media/tool-dependent. such as handing NSDate in JSON. </p>
    <p>set UUID for new/unmanaged object</p></td>
    <td><p>model</p>
    <p>storeURL, presently ~/Documents, for debugging</p></td>
  </tr>
  <tr>
    <td>access</td>
    <td>relationship uuid only</td>
    <td>&nbsp;</td>
    <td><p>modelType</p>
    <p>storeURL/dirURL.</p></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>Comparison (by example)</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>UseCase_modelType</td>
    <td>FSAccessContext</td>
    <td>FSAccess_modelType</td>
  </tr>
  <tr>
    <td>addObject</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>error </td>
    <td>NO. UseCase should handle all technical errors that Content returns</td>
    <td>return error by-ref</td>
    <td>return error by-ref</td>
  </tr>
  <tr>
    <td>return</td>
    <td>same as context</td>
    <td><p>object:</p>
      <ul>
        <li>cached</li>
        <li>mutableDictionary</li>
        <li>with UUID</li>
    </ul></td>
    <td>UUID or nil</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Do not remove your old but functioning code just because of requirement change, the req may change  back later. Set it as a kind of style.</p>
<p>&nbsp;</p>
<p><a href="https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html">https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Object Depth</h2>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>0</td>
    <td>object's ID only</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>1</td>
    <td>object's attributes + relationship's depth 0</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<h2>Data's polymorphism</h2>
<p>You have learnt of OOP's method polymorphism, but not data one. What I mean data polymorphism is:</p>
<h3><a href="http://en.wikipedia.org/wiki/Intension">Intension</a></h3>
<p>For an semantic/business instance, it may have multiple representations or forms. One of them is typical/standard one, but other representations are perfectly OK to reference to the same instance. For examples:</p>
<h3><a href="http://en.wikipedia.org/wiki/Extension_(semantics)">Extension (semantics)</a></h3>
<ul>
  <li>For a local file or http resource address, NSURL is typical one, but NSString is also OK.</li>
  <li>NSUUID is standard one for UUID, but NSString and uuid_t are OK too.</li>
  <li>An object can has a specific model class, or NSDictionary, or even NSString in JSON or other formats.</li>
</ul>
<p>-</p>
<p>content vs form, semantics vs structure/type. </p>
<p>datatype is just a form. it is NOT a content. it has NO semantics. </p>
<p>&nbsp;</p>
<h2>API</h2>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>add and remove</td>
    <td><p>- (id) addObject: (id) object<br />
      ofModelType: (SHCCEnum_ModelType) modelType<br />
      error:(NSError *__autoreleasing *) error;</p>
      <p>- (BOOL) removeObject: (id) object<br />
        ofModelType: (SHCCEnum_ModelType) modelType<br />
        error:(NSError *__autoreleasing *) error;<br />
    </p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>update. wholesale mode</td>
    <td>- (BOOL) updateObject: (id) object<br />
ofModelType: (SHCCEnum_ModelType) modelType<br />
error:(NSError *__autoreleasing *) error;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>update. retails mode. to-one</td>
    <td><p>- (id) updateObject:(id)object<br />
      ofModelType: (SHCCEnum_ModelType) modelType<br />
      setValue:(id)value<br />
      onRelationship:(id)rel<br />
      error:(NSError *__autoreleasing *) error;</p>
      <p>- (BOOL) updateObject:(id)object<br />
        ofModelType: (SHCCEnum_ModelType) modelType<br />
        resetValue:(id)value<br />
        onRelationship:(id)rel<br />
    error:(NSError *__autoreleasing *) error;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>update. retails model. to-many</td>
    <td><p>- (id) updateObject:(id)object<br />
      ofModelType: (SHCCEnum_ModelType) modelType<br />
      addValue:(id)value<br />
      onRelationship:(id)rel<br />
      error:(NSError *__autoreleasing *) error;</p>
      <p>- (BOOL) updateObject:(id)object<br />
        ofModelType: (SHCCEnum_ModelType) modelType<br />
        removeValue:(id)value<br />
        onRelationship:(id)rel<br />
    error:(NSError *__autoreleasing *) error;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>4-fsaccesscontext-impl</h1>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
