<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>iOS-Procedure-UIVCAssistant</title>
</head>

<body>
<h1>iOS-Procedure-UIVCAssistant/Action</h1>
<ul>
  <li>Inhertis NSObject, not in VC bloodline</li>
  <li>work at VC level, (7-UIVCAction) thinking of VC's business - UIBarButtonItem </li>
  <li>not singleton</li>
  <li>accomplish specific task of VC only, narrow-minded</li>
  <li>has reference to VC. AND know specific type of VC! -- argueably, it may not have to know the type of VC. For one model, there will be multiple VCs for it. VCA is, after all, model-oriented, not VC-oriented.</li>
</ul>
<p>&nbsp;</p>
<h2>Mechanism</h2>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>Design Principle</td>
    <td>Coding Principle</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Ownership</td>
    <td>VCAs are created by UIStory (previously UIVC). </td>
    <td>no ivar for VCA in VC</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>UIVC-UIVCA combination is NOT up to VC, but beyond VC, e.g. on UIStory</td>
    <td>no VC-VCA linking code in [-viewDidLoad]</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>VC-VC</td>
    <td>VC does not know eahc other, either class or instance.</td>
    <td>in VC, you cannot see the name of another VC</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>One VC may have more than zero VCAs to assist it to work. Since each VCA offers a UIBarButtonItem object for VC to use, VCA should define its action or actions according.</p>
<p>VC can create VCAs as early as possible, e.g. in [-init]; while uses them, at least during [-viewDidLoad], and [- setObject:]</p>
<p>VCA may have delegate for its result/completion of action. Therefore VC must be its delegate. </p>
<p>VCA needs a VC reference, to either present other VC in need, or view related. But that is not the reason to access VC's properties ?????</p>
<p>&nbsp;</p>
<p>From Model perspective,</p>
<p>Model's properties / data will be presented in VC</p>
<p>Model's methods / actions can be in VCAs. Or some methods/actions group can be presented in one VCA.</p>
<p>&nbsp;</p>
<h2>History/Evolution</h2>
<p>In the beginning, I want some logic in VC moved outside, to make VC thinner. that is why I firstly called it Assistant.</p>
<p>Later on, I found it may be used as the action of the same model object as VC. So it should be </p>
<p>&nbsp;</p>
<h2>Class Inheritance</h2>
<ul>
  <li>NSObject
    <ul>
      <li>JXUIVCAssistant__base
        <ul>
          <li>JXUIVCAssistant__base__actionlist
            <ul>
              <li>SHPSVCAction_UIImage_Sharing</li>
            </ul>
          </li>
          <li>JXUIVCA_NSURL_FileSystem</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>delegate </td>
    <td>subclassing</td>
  </tr>
  <tr>
    <td>JXUIVCAssistant__base</td>
    <td><p>- (id) initWithViewController: (UIViewController*) viewController;</p>
      <p>@property (nonatomic, strong) UIViewController * viewController;</p>
    <p>@property (nonatomic, strong) id object; </p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>JXUIVCAssistant__base__actionlist</td>
    <td><p>@property (nonatomic, readonly) UIBarButtonItem * buttonItem;</p>
      <p>@property (nonatomic, readonly) UIButton * button;<br />
      </p>
      <p>@property (nonatomic, assign) BOOL usesButton;<br />
      </p>
      <p>@property (nonatomic, strong) NSArray * actionTitles;<br />
      </p>
    <p>- (BOOL) handleActionAtIndex: (NSInteger) index ;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>JXUIVCAction_Image_Sharing</td>
    <td><p>JXUIVCAction_Image_Sharing * vca_image_sharing = [];</p>
      <p>vca_image_sharing.object = // UIImage</p>
    <p>vca_image_sharing.buttonItem; </p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>JXUIVCA_NSURL_FileSystem</td>
    <td><p>&nbsp;</p>
    <p>If the URL is for file, then showing file's ops.</p>
    <p>If the URL is for directory, then directory's ops. </p>
    <p>&nbsp;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<ul>
  <li>JXUIVCAssistant__base__actionlist
    <ul>
      <li>JXUIVCAction_UIImage_Share</li>
    </ul>
  </li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<ul>
  <li>JXUIVCAssistant__base
    <ul>
      <li>JXUIVCAction_base
        <ul>
          <li>JXUIVCAction_UIImage_Mail</li>
          <li>JXUIVCAction_UIImage_Pick</li>
          <li>JXUIVCAction_UIImage_Print</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>JXUIVCAction_base</td>
    <td><p>- (BOOL) canPerform;</p>
      <p>- (void) perform ;</p>
      <p>@property (nonatomic, strong) UIBarButtonItem * buttonItem;<br />
      </p>
    <p>+ (NSString*) title;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>JXUIVCAction_UIImage_Mail</p>
    <p>&lt;MFMailComposeViewControllerDelegate&gt;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>JXUIVCAction_UIImage_Pick</p>
    <p>&lt;UIImagePickerControllerDelegate, UINavigationControllerDelegate,</p>
    <p>UIPopoverControllerDelegate<br />
    &gt;</p></td>
    <td>@property (nonatomic, strong)JXBlock_Object resultBlock;<br />
    @property (nonatomic, strong)JXBlock_Error errorBlock;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>JXUIVCAction_UIImage_Print</p>
    <p>&lt;UIPrintInteractionControllerDelegate&gt;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Usage (in UIVC)</p>
<p>make or buy ? if buy, then vca is assigned from outside, then this VC is more flexible.. </p>
<p>if make, then this vc have to make vcs. </p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>.h</p>
    <p>conform VCA delegate</p>
    <p>&nbsp;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>.m </p>
    <p>define ivar for vca(s)</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>&nbsp;</p>
      <p>in [- viewDidLoad] , vca must be ready??</p>
    <p>&nbsp;</p></td>
    <td><p>self.navigationItem.rightButtonItem = _vca.buttonItem.; </p>
    <p>&nbsp;</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Action Management</h2>
<p>One VC's model may have some operations/actions for it. Actions can be readonly or readwrite. they can be either zero-parameter or parameter-ful. </p>
<ul>
  <li>zero-param: </li>
  <li>param-ful : </li>
</ul>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Order (item)</td>
    <td><ul>
      <li>show List</li>
      <li>show Format (JSON)</li>
      <li>place Order (inc. place sub order)</li>
    </ul></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<h2>Orientation/Direction of naming</h2>
<p>majority of relationship are bi-directional. If A is B's something, then B must be A's something else too. Which directional is primary, is up to developer's Arbitrariness(随意性). Such freedom/randomness/Arbitrarinesss causes problem. </p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>source driven </p>
    <p>push</p></td>
    <td>Dish_BeAddedIntoOrder</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>destination driven</p>
    <p>pull</p></td>
    <td>Order_addOrderItemOfDish</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<h3>properties for VCA</h3>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>primary property</td>
    <td>&nbsp;</td>
    <td>id object</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>secondary properties</td>
    <td><p>by-name</p>
    <p>type-specific</p></td>
    <td><p>id order</p>
    <p>SHEMModel_Order * order</p>
    <p>id&lt;SHEMModel_Order&gt; order </p></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
