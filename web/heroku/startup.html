<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>startup</title>
</head>

<body>
<p>Heroku</p>
<p>&nbsp;</p>
<p>Startup</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>git push heroku master</td>
    <td><p>Counting objects: 6, done.<br />
      Delta compression using up to 4 threads.<br />
      Compressing objects: 100% (5/5), done.<br />
      Writing objects: 100% (6/6), 682 bytes, done.<br />
      Total 6 (delta 0), reused 0 (delta 0)</p>
      <p>-----&gt; Ruby/Rack app detected<br />
    -----&gt; Installing dependencies using Bundler version 1.3.2</p>
    <p>&nbsp;</p>
    <p>-----&gt; Discovering process types<br />
Procfile declares types     -&gt; web<br />
Default types for Ruby/Rack -&gt; console, rake</p>
    <p>&nbsp;</p>
    <p>-----&gt; Compiled slug size: 2.2MB<br />
      -----&gt; Launching... done, v4<br />
http://quiet-atoll-8841.herokuapp.com deployed to Heroku</p>
    <p>&nbsp;</p>
    <p>To git@heroku.com:quiet-atoll-8841.git<br />
* [new branch]      master -&gt; master</p></td>
    <td><p>Permission denied (publickey).<br />
    fatal: The remote end hung up unexpectedly</p>
    <p>&nbsp;</p>
    <p><a href="http://stackoverflow.com/questions/4269922/permission-denied-publickey-when-deploying-heroku-code-fatal-the-remote-end">Permission denied (publickey) when deploying heroku code. fatal: The remote end hung up unexpectedly</a></p>
    <p>&nbsp;</p>
    <p>heroku keys:add ~/.ssh/id_rsa.pub</p>
    <p>if not having id_rsa.pub</p>
    <p>heroku keys:add</p>
    <p>http://devcenter.heroku.com/articles/keys#adding_keys_to_heroku</p></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin --deployment<br />
You are trying to install in deployment mode after changing<br />
your Gemfile. Run `bundle install` elsewhere and add the<br />
updated Gemfile.lock to version control.<br />
You have added to the Gemfile:<br />
* activerecord<br />
* sinatra-activerecord<br />
* sqlite3<br />
* pg<br />
!<br />
!     Failed to install gems via Bundler.<br />
!<br />
!     Heroku push rejected, failed to compile Ruby/rack app</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td><p>-----&gt; Writing config/database.yml to read from DATABASE_URL<br />
      -----&gt; Discovering process types<br />
      Procfile declares types     -&gt; web<br />
      Default types for Ruby/Rack -&gt; console, rake</p>
      <p>-----&gt; Compiled slug size: 3.5MB<br />
        -----&gt; Launching... done, v6<br />
    http://quiet-atoll-8841.herokuapp.com deployed to Heroku</p></td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>http://stackoverflow.com/questions/4269922/permission-denied-publickey-when-deploying-heroku-code-fatal-the-remote-end</p>
<p>&nbsp;</p>
<p>$ heroku open</p>
<p>&nbsp;</p>
<h2>DB migration</h2>
<p>Migration is a concept in activerecord, which in turn can be used with Sinatra.</p>
<p>https://github.com/baloi/sinatra_sample/blob/master/howto.txt</p>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>create migration</td>
    <td>rake db:create_migration NAME=create_dish</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>migrate</td>
    <td>rake db:migrate</td>
    <td>&nbsp;</td>
    <td>heroku run rake db:migrate</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Addons - Postgresql </h2>
<p>https://addons.heroku.com/heroku-postgresql</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>$ heroku addons:add heroku-postgresql:dev</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>If you click &quot;Add Dev for Free&quot; button more than one time, you will get mutliple addons (of the same type, in this case, postgresql), with different &quot;color&quot; names.</p>
<p>&nbsp;</p>
<table width="100%" border="1">
  <tr>
    <td>&nbsp;</td>
    <td>CLI</td>
    <td>website</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><p>heroku addons:add heroku-postgresql:dev</p>
      <p><br />
        Adding heroku-postgresql:dev on quiet-atoll-8841... done, v12 (free)<br />
        Attached as HEROKU_POSTGRESQL_COBALT_URL<br />
        Database has been created and is available<br />
        ! This database is empty. If upgrading, you can transfer<br />
        ! data from another database with pgbackups:restore.<br />
    Use `heroku addons:docs heroku-postgresql:dev` to view documentation.</p></td>
    <td><p>https://addons.heroku.com/heroku-postgresql</p>
    <p>Added heroku-postgresql:dev to quiet-atoll-8841 (Free). Attached as HEROKU_POSTGRESQL_BLACK_URL Database has been created and is available ! This database is empty. If upgrading, you can transfer ! data from another database with pgbackups:restore.</p></td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><p>heroku config</p>
      <p><br />
        === quiet-atoll-8841 Config Vars<br />
        DATABASE_URL:                 sqlite:///development.db<br />
        HEROKU_POSTGRESQL_BLACK_URL:  postgres://poevubaexfkrck:SOfbI1AIAM5qEZQlSkhWc16tUi@ec2-107-22-169-108.compute-1.amazonaws.com:5432/d2dov6ofp0hb1m<br />
    HEROKU_POSTGRESQL_COPPER_URL: postgres://nhjmplubkbngdl:VYVK-QAJVUXYjhLh4wTSc2tSpT@ec2-23-21-161-255.compute-1.amazonaws.com:5432/d94thv9m47u2or</p></td>
    <td>https://postgres.heroku.com/databases</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><p>heroku pg:promote HEROKU_POSTGRESQL_BLACK_URL</p>
      <p><br />
    Promoting HEROKU_POSTGRESQL_BLACK_URL to DATABASE_URL... done</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><p>heroku run rake db:migrate</p>
      <p> <br />
        Running `rake db:migrate` attached to terminal... up, run.4044<br />
        (in /app)<br />
        /usr/local/bin/rake<br />
        /app/web.rb<br />
        /app/web.rb<br />
        ==  CreateRoles: migrating ====================================================<br />
        -- create_table(:users)<br />
        NOTICE:  CREATE TABLE will create implicit sequence &quot;users_id_seq&quot; for serial column &quot;users.id&quot;<br />
        NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index &quot;users_pkey&quot; for table &quot;users&quot;<br />
        -&gt; 0.2161s<br />
    ==  CreateRoles: migrated (0.2163s) ===========================================</p></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
